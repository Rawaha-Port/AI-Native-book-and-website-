# Data Model for Better Auth with Drizzle ORM

This data model describes the entities managed by the `better-auth` service via Drizzle ORM, primarily for user authentication and session management. The actual Drizzle schema will be generated by the `@better-auth/cli` tool and defined in `db/schema.ts`.

## Entities

### User
Represents a user account.
-   `id`: UUID (Primary Key, unique identifier for the user within `better-auth`).
-   `email`: String (Unique, not null, user's email address).
-   `emailVerified`: DateTime (Timestamp of when the email was verified).
-   `name`: String (User's display name).
-   `passwordHash`: String (Hashed password for email/password provider).
-   `createdAt`: DateTime (Timestamp of user creation).
-   `updatedAt`: DateTime (Timestamp of last update).

### Account
Links a user to a specific authentication provider (e.g., email/password, Google, GitHub).
-   `id`: UUID (Primary Key).
-   `userId`: UUID (Foreign Key to User.id).
-   `provider`: String (e.g., "email", "github").
-   `providerAccountId`: String (Unique ID from the provider).
-   `type`: String (e.g., "oauth", "email", "credentials").
-   `refreshToken`: String (OAuth refresh token).
-   `accessToken`: String (OAuth access token).
-   `expiresAt`: Integer (OAuth token expiration time in seconds).
-   `tokenType`: String (OAuth token type).
-   `scope`: String (OAuth scopes granted).
-   `idToken`: String (OAuth ID token).
-   `sessionState`: String (OAuth session state).

### Session
Represents an active user session.
-   `id`: UUID (Primary Key).
-   `userId`: UUID (Foreign Key to User.id).
-   `expires`: DateTime (Session expiration timestamp).
-   `sessionToken`: String (Unique session token).

### VerificationToken
Used for email verification or password reset flows.
-   `identifier`: String (e.g., email address).
-   `token`: String (Unique verification token).
-   `expires`: DateTime (Token expiration timestamp).

## Relationships

-   **User has many Accounts**: A user can have multiple linked authentication methods.
-   **User has many Sessions**: A user can have multiple active sessions.
-   **Account belongs to User**: Each account belongs to a single user.
-   **Session belongs to User**: Each session belongs to a single user.

## Mapping to Existing FastAPI Backend

The FastAPI backend's `src/models.py` currently has a `User` table. It contains `id`, `email`, `full_name`, `password_hash`, and `better_auth_id`.
*   The `better_auth_id` in the FastAPI `User` table will link to the `User.id` in the `better-auth` Drizzle schema.
*   The `password_hash` in the FastAPI `User` table will become a placeholder as `better-auth` manages the actual password hashing.
*   The `full_name` will be managed by the FastAPI backend directly, or potentially synced from `better-auth`'s `User.name` field if configured.

This design ensures `better-auth` handles the core authentication lifecycle, while FastAPI manages user profiles and other application-specific data.